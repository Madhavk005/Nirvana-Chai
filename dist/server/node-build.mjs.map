{"version":3,"file":"node-build.mjs","sources":["../../server/routes/demo.ts","../../server/routes/forms.ts","../../server/index.ts","../../server/node-build.ts"],"sourcesContent":["import { RequestHandler } from \"express\";\nimport { DemoResponse } from \"@shared/api\";\n\nexport const handleDemo: RequestHandler = (req, res) => {\n  const response: DemoResponse = {\n    message: \"Hello from Express server\",\n  };\n  res.status(200).json(response);\n};\n","import { RequestHandler } from \"express\";\nimport nodemailer from \"nodemailer\";\n\n// Create email transporter\nconst createTransporter = () => {\n  return nodemailer.createTransport({\n    host: \"smtp-mail.outlook.com\",\n    port: 587,\n    secure: false, // true for 465, false for other ports\n    auth: {\n      user: process.env.EMAIL_USER,\n      pass: process.env.EMAIL_PASS,\n    },\n  });\n};\n\n// Newsletter subscription\nexport const handleNewsletterSignup: RequestHandler = async (req, res) => {\n  try {\n    const { email } = req.body;\n\n    if (!email) {\n      return res.status(400).json({ error: \"Email is required\" });\n    }\n\n    // Validate email format\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n    if (!emailRegex.test(email)) {\n      return res.status(400).json({ error: \"Invalid email format\" });\n    }\n\n    // Log to console instead of sending email (development mode)\n    console.log(\"ðŸ“§ Newsletter signup:\", {\n      email,\n      timestamp: new Date().toISOString(),\n      type: \"newsletter_subscription\",\n    });\n\n    res.status(200).json({\n      message: \"Successfully subscribed to newsletter\",\n      email: email,\n    });\n  } catch (error) {\n    console.error(\"Newsletter signup error:\", error);\n    res.status(500).json({ error: \"Failed to process subscription\" });\n  }\n};\n\n// Contact form\nexport const handleContactForm: RequestHandler = async (req, res) => {\n  try {\n    const { name, email, subject, message } = req.body;\n\n    if (!name || !email || !message) {\n      return res\n        .status(400)\n        .json({ error: \"Name, email, and message are required\" });\n    }\n\n    // Log to console instead of sending email (development mode)\n    console.log(\"ðŸ“§ Contact form submission:\", {\n      name,\n      email,\n      subject: subject || \"No subject\",\n      message: message.substring(0, 100) + (message.length > 100 ? \"...\" : \"\"),\n      timestamp: new Date().toISOString(),\n      type: \"contact_form\",\n    });\n\n    res.status(200).json({\n      message: \"Message sent successfully\",\n      data: { name, email, subject },\n    });\n  } catch (error) {\n    console.error(\"Contact form error:\", error);\n    res.status(500).json({ error: \"Failed to send message\" });\n  }\n};\n\n// Login attempt notification\nexport const handleLoginAttempt: RequestHandler = async (req, res) => {\n  try {\n    const { email } = req.body;\n\n    if (!email) {\n      return res.status(400).json({ error: \"Email is required\" });\n    }\n\n    // Log to console instead of sending email (development mode)\n    console.log(\"ðŸ” Login attempt:\", {\n      email,\n      timestamp: new Date().toISOString(),\n      ip: req.ip || \"Unknown\",\n      type: \"login_attempt\",\n    });\n\n    res.status(200).json({ message: \"Login attempt logged\" });\n  } catch (error) {\n    console.error(\"Login attempt logging error:\", error);\n    res.status(500).json({ error: \"Failed to log login attempt\" });\n  }\n};\n\n// Registration notification\nexport const handleRegistration: RequestHandler = async (req, res) => {\n  try {\n    const { firstName, lastName, email } = req.body;\n\n    if (!firstName || !lastName || !email) {\n      return res.status(400).json({ error: \"All fields are required\" });\n    }\n\n    // Log to console instead of sending email (development mode)\n    console.log(\"ðŸ‘¤ New user registration:\", {\n      name: `${firstName} ${lastName}`,\n      email,\n      timestamp: new Date().toISOString(),\n      type: \"user_registration\",\n    });\n\n    res.status(200).json({\n      message: \"Registration successful\",\n      data: { firstName, lastName, email },\n    });\n  } catch (error) {\n    console.error(\"Registration error:\", error);\n    res.status(500).json({ error: \"Failed to process registration\" });\n  }\n};\n\n// Order placement notification\nexport const handleOrderPlacement: RequestHandler = async (req, res) => {\n  try {\n    const {\n      shippingInfo,\n      cartItems,\n      paymentMethod,\n      orderTotal,\n      subtotal,\n      shipping,\n      tax,\n    } = req.body;\n\n    if (!shippingInfo || !cartItems || !orderTotal) {\n      return res.status(400).json({ error: \"Order details are required\" });\n    }\n\n    // Log to console instead of sending email (development mode)\n    console.log(\"ðŸ›’ New order received:\", {\n      orderId: Date.now().toString(),\n      customer: `${shippingInfo.firstName} ${shippingInfo.lastName}`,\n      email: shippingInfo.email,\n      items: cartItems.map((item: any) => `${item.name} (x${item.quantity})`),\n      total: `$${orderTotal.toFixed(2)}`,\n      paymentMethod,\n      timestamp: new Date().toISOString(),\n      type: \"order_placement\",\n    });\n\n    res.status(200).json({\n      message: \"Order placed successfully\",\n      orderId: Date.now().toString(),\n    });\n  } catch (error) {\n    console.error(\"Order placement error:\", error);\n    res.status(500).json({ error: \"Failed to process order\" });\n  }\n};\n","import \"dotenv/config\";\nimport express from \"express\";\nimport cors from \"cors\";\nimport { handleDemo } from \"./routes/demo\";\nimport {\n  handleNewsletterSignup,\n  handleContactForm,\n  handleLoginAttempt,\n  handleRegistration,\n  handleOrderPlacement,\n} from \"./routes/forms\";\n\nexport function createServer() {\n  const app = express();\n\n  // Middleware\n  app.use(cors());\n  app.use(express.json());\n  app.use(express.urlencoded({ extended: true }));\n\n  // Health check endpoint\n  app.get(\"/health\", (_req, res) => {\n    res.json({\n      status: \"healthy\",\n      timestamp: new Date().toISOString(),\n      uptime: process.uptime(),\n    });\n  });\n\n  // Example API routes\n  app.get(\"/api/ping\", (_req, res) => {\n    const ping = process.env.PING_MESSAGE ?? \"ping\";\n    res.json({ message: ping });\n  });\n\n  app.get(\"/api/demo\", handleDemo);\n\n  // Form submission routes\n  app.post(\"/api/forms/newsletter\", handleNewsletterSignup);\n  app.post(\"/api/forms/contact\", handleContactForm);\n  app.post(\"/api/forms/login-attempt\", handleLoginAttempt);\n  app.post(\"/api/forms/register\", handleRegistration);\n  app.post(\"/api/forms/order\", handleOrderPlacement);\n\n  return app;\n}\n","import path from \"path\";\nimport { createServer } from \"./index\";\nimport * as express from \"express\";\n\nconst app = createServer();\nconst port = process.env.PORT || 3000;\n\n// In production, serve the built SPA files\nconst __dirname = import.meta.dirname;\nconst distPath = path.join(__dirname, \"../spa\");\n\n// Serve static files\napp.use(express.static(distPath));\n\n// Handle React Router - serve index.html for all non-API routes\napp.get(\"*\", (req, res) => {\n  // Don't serve index.html for API routes\n  if (req.path.startsWith(\"/api/\") || req.path.startsWith(\"/health\")) {\n    return res.status(404).json({ error: \"API endpoint not found\" });\n  }\n\n  res.sendFile(path.join(distPath, \"index.html\"));\n});\n\napp.listen(port, () => {\n  console.log(`ðŸš€ Fusion Starter server running on port ${port}`);\n  console.log(`ðŸ“± Frontend: http://localhost:${port}`);\n  console.log(`ðŸ”§ API: http://localhost:${port}/api`);\n});\n\n// Graceful shutdown\nprocess.on(\"SIGTERM\", () => {\n  console.log(\"ðŸ›‘ Received SIGTERM, shutting down gracefully\");\n  process.exit(0);\n});\n\nprocess.on(\"SIGINT\", () => {\n  console.log(\"ðŸ›‘ Received SIGINT, shutting down gracefully\");\n  process.exit(0);\n});\n"],"names":["app","express"],"mappings":"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"}